graph TD
    %% MCP SYSTEM - Complete Architecture
    %% Generated by LangGraph Studio Export Manager
    
    %% Styling
    classDef startEnd fill:#e1f5fe,stroke:#01579b,stroke-width:3px,color:#fff
    classDef reasoning fill:#f3e5f5,stroke:#4a148c,stroke-width:2px,color:#fff
    classDef execution fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px,color:#fff
    classDef evaluation fill:#fff3e0,stroke:#e65100,stroke-width:2px,color:#fff
    classDef decision fill:#fce4ec,stroke:#880e4f,stroke-width:2px,color:#fff
    classDef memory fill:#f1f8e9,stroke:#33691e,stroke-width:2px,color:#fff
    classDef llm fill:#ffebee,stroke:#c62828,stroke-width:2px,color:#fff
    
    %% Main Flow Nodes
    START([🚀 START]):::startEnd
    INIT[🔧 Initialize Session<br/>📋 Config & Memory]:::memory
    HEALTH[❤️ Health Check<br/>🔍 System Status]:::evaluation
    REASON[🧠 Enhanced Reasoning<br/>📝 Task Analysis & Planning]:::reasoning
    SELECT[🎯 Adaptive Selection<br/>🤖 Auto-detect Best Model]:::decision
    EXECUTE[⚡ Execute LLM<br/>🔥 Local Models + Langwatch]:::llm
    EVALUATE[📊 Enhanced Reward<br/>🏆 Multi-dimensional Scoring]:::evaluation
    CONTRADICTION[🔥 Contradiction Analysis<br/>💡 Failure Detection & Learning]:::decision
    RETRY[🔄 Intelligent Retry<br/>🎲 Strategy Selection]:::decision
    FINALIZE[✅ Finalize Results<br/>💾 Save & Cleanup]:::memory
    END([🏁 END]):::startEnd
    
    %% Local LLM Nodes
    MISTRAL[🧙‍♂️ Mistral Local<br/>General Reasoning]:::llm
    LLAMA[🦙 LLaMA Local<br/>Text Generation]:::llm
    DEEPSEEK[🔬 DeepSeek Local<br/>Math & Logic]:::llm
    
    %% Main Flow
    START --> INIT
    INIT --> HEALTH
    HEALTH --> REASON
    REASON --> SELECT
    SELECT --> EXECUTE
    EXECUTE --> EVALUATE
    EVALUATE --> CONTRADICTION
    CONTRADICTION --> RETRY
    RETRY --> FINALIZE
    FINALIZE --> END
    
    %% Model Selection Flow
    SELECT -.->|Math/Logic| DEEPSEEK
    SELECT -.->|General| MISTRAL
    SELECT -.->|Text Gen| LLAMA
    DEEPSEEK -.-> EXECUTE
    MISTRAL -.-> EXECUTE
    LLAMA -.-> EXECUTE
    
    %% Conditional Edges
    HEALTH -->|❌ System Unhealthy| END
    EVALUATE -->|⭐ Score >= 0.8| FINALIZE
    EVALUATE -->|📉 Score < 0.8| CONTRADICTION
    CONTRADICTION -->|🔥 Apply Contradiction| REASON
    CONTRADICTION -->|✅ No Contradiction Needed| RETRY
    RETRY -->|🔄 Retry with Same Model| SELECT
    RETRY -->|🔀 Try Different Model| SELECT
    RETRY -->|🛑 Max Retries Reached| FINALIZE
    
    %% Langwatch Integration (invisible connections)
    EXECUTE -.->|📊 Track Metrics| EVALUATE
    CONTRADICTION -.->|📈 Effectiveness Analysis| RETRY
    
    %% Metadata
    %% Total Nodes: 14
    %% Total Edges: 16
    %% Features: Reasoning, Reward, Contradiction, Retry, Memory, Local LLMs, Langwatch
    %% Models: Mistral, LLaMA, DeepSeek (.gguf format)
    %% Monitoring: Real-time debugging, Session tracking, Performance metrics
